function facilitiesCtrl(a,b,c,d){function e(c){var d=Parse.Object.extend("Facility"),e=new d;e.set("title",a.facilityTitle),e.set("feature",a.facilityFeature),e.set("description",a.facilityDescription),e.set("picture",c),e.save({success:function(){var c=UIkit.modal("#add");c.isActive()?c.hide():c.show(),b.notification("Facility has been saved"),a.isLoadingFacilities.add=!1,h()},error:function(a){b.notification("Something went wrong")}})}function f(c){var d=Parse.Object.extend("Facility"),e=new d;e.id=a.editFacilityItem.id,e.set("title",a.editFacilityItem.title),e.set("feature",a.editFacilityItem.feature),e.set("description",a.editFacilityItem.description),null!=c&&e.set("picture",c),e.save({success:function(){var c=UIkit.modal("#edit");c.isActive()?c.hide():c.show(),b.notification("Facility has been saved"),a.isLoadingFacilities.edit=!1,h()},error:function(a){b.notification("Something went wrong")}})}function g(c){var d=Parse.Object.extend("Facility");new Parse.Query(d).get(c.id,{success:function(c){c.destroy({success:function(){var c=UIkit.modal("#delete");c.isActive()?c.hide():c.show(),b.notification("Facility has been removed"),a.isLoadingFacilities.delete=!1,h()},error:function(){b.notification("Something went wrong")}})},error:function(a,c){b.notification("Something went wrong")}})}function h(){var c=Parse.Object.extend("Facility");new Parse.Query(c).find({success:function(b){a.facilitiesImages=[];for(var c in b)a.facilitiesImages.push({id:b[c].id,picture:b[c].get("picture"),feature:b[c].get("feature"),description:b[c].get("description"),title:b[c].get("title")});a.$apply()},error:function(a){b.notification("Something went wrong")}})}a.facilitiesImages=[],a.facilityImage=null,a.facilityFeature=null,a.facilityTitle=null,a.facilityDescription=null,a.isLoadingFacilities={add:!1,edit:!1,delete:!1},h(),a.addFacility=function(){if(a.facilityImage=$("#facilityPicture")[0].files[0],a.isLoadingFacilities.add=!0,null==a.facilityFeature)b.notification("Feature must specified"),a.isLoadingFacilities.add=!1;else if(null==a.facilityImage)b.notification("No Image uploaded"),a.isLoadingFacilities.add=!1;else if(null==a.facilityTitle)b.notification("Title must specified"),a.isLoadingFacilities.add=!1;else if(null==a.facilityDescription)b.notification("Description must specified"),a.isLoadingFacilities.add=!1;else{var c=new FileReader;c.readAsDataURL(a.facilityImage),c.onload=function(){new Parse.File($("#facilityPicture")[0].files[0].name,{base64:c.result}).save({success:function(a){e(a)},error:function(a){b.notification("Something went wrong")}})},c.onerror=function(a){b.notification("Something went wrong")}}},a.editFacility=function(b){a.editFacilityItem=b},a.deleteFacility=function(b,c){a.deleteFacilityItem=b},a.updateFacility=function(){if(a.facilityImage=$("#editImageFacility")[0].files[0],a.isLoadingFacilities.edit=!0,""==a.editFacilityItem.title)b.notification("Title must specified"),a.isLoadingFacilities.edit=!1;else if(""==a.editFacilityItem.feature)b.notification("Feature must specified"),a.isLoadingFacilities.edit=!1;else if(""==a.editFacilityItem.description)b.notification("Description must specified"),a.isLoadingFacilities.edit=!1;else if(null!=a.facilityImage){var c=new FileReader;c.readAsDataURL(a.facilityImage),c.onload=function(){new Parse.File($("#editImageFacility")[0].files[0].name,{base64:c.result}).save({success:function(a){f(a)},error:function(a){b.notification("Something went wrong")}})},c.onerror=function(a){b.notification("Something went wrong")}}else f(null)},a.dropFacility=function(){a.isLoadingFacilities.delete=!0,g(a.deleteFacilityItem)}}angular.module("Admin").controller("facilitiesCtrl",facilitiesCtrl),facilitiesCtrl.$inject=["$scope","uikitService","$state","$localStorage"];